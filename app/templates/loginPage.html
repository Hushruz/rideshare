{% extends "layout.html" %}

{% block title %}Login{% endblock %}

{% block head %}
<script type="text/javascript">

</script>
{% endblock %}

{% block wide %}
<div class="login">
    {% if redirect %}
    <div class="panel panel-default">
        <div class="panel-body">
            You must login before you can visit that page. You will be redirected after you login. If you do not have an account, just select how you would like to login and you will still be redirected.
        </div>
    </div>
    {% endif %}
    <div class="alert alert-info">
        <strong>Heads up!</strong>
        Sign in with your email or use a social tool below.
    </div>
    <div class="panel panel-main">
        <div class="panel-heading">Sign In</div>
        <div class="panel-body">

            <form data-form='login'>
                <div class="form-group">
                    <label>Email address</label>
                    <input type="email" class='form-control' placeholder='Enter email' name='email'>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" class='form-control' placeholder='Password' name='password'>
                </div>
                <button type="submit" class="btn btn-default">Sign In</button>
            </form>
            <hr>
            <h2>Social Login</h2>
            <div class="btns">
                <a class='btn btn-primary' href='/auth/google'>
                    <i class='fa fa-google'></i>
                    Google
                </a>
                <a class='btn btn-primary' href='/auth/facebook'>
                    <i class='fa fa-facebook'></i>
                    Facebook
                </a>
                <a class='btn btn-primary' href='/auth/twitter'>
                    <i class='fa fa-twitter'></i>
                    Twitter
                </a>
            </div>
        </div>
    </div>
    <button class="btn btn-primary btn-lg btn-block" data-toggle="modal" data-target="#register">
        <b>New to Ridecircles?</b> Sign up.
    </button>
</div>

<div class="modal fade" id="register" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
                <h4 class="modal-title">Sign Up</h4>
            </div>
            <div class="modal-body">
                <form data-form='register'>
                    <div class="form-group">
                        <label>Email address</label>
                        <input type="email" class='form-control' placeholder='Enter email' name='email'>
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" class='form-control' placeholder='Password' name='password'>
                    </div>
                    <button type="submit" class="btn btn-default">Sign Up</button>
                </form>
            </div>
            <!-- <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div> -->
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src='/static/push.js'></script>
{% raw %}
<script data-notify="template" type='text/x-handlebars-template'>
    <div class="alert alert-{{type}} alert-dismissable">
        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
        <strong>{{strong}}</strong>
        {{message}}
    </div>
</script>
{% endraw %}
<script type="text/javascript">
    var register = document.querySelector('[data-form="register"]');
    var login = document.querySelector('[data-form="login"]');

    var register_submit = new SubmitForm({
        form: register,
        model: {
            email: '',
            password: ''
        },
        method: 'POST',
        route: '/register',
        done: function (data) {
            document.location = data.redirect;
        },
        fail: function (message, status) {
            notify({
                type: 'danger',
                strong: 'Oh no!',
                message: 'Something went wrong. Try agian.'
            });
        }
    });

    var login_submit = new SubmitForm({
        form: login,
        model: {
            email: '',
            password: ''
        },
        method: 'POST',
        route: '/login',
        done: function (data) {
            document.location = data.redirect;
        },
        fail: function (message, status) {
            notify({
                type: 'danger',
                strong: 'Oh no!',
                message: 'Something went wrong. Try agian.'
            });
        }
    });
</script>
{% endblock %}

